- name: Check PVCs status
  k8s_info:
    host: "{{ url }}"
    api_key: "{{ token }}"
    verify_ssl: no
    kind: PersistentVolumeClaim 
    namespace: "{{ namespace }}"
    label_selectors: "app={{ app_name }}"
  register: app_pvc

- name: delete PVCs to create Terminating status
  k8s:
    host: "{{ url }}"
    api_key: "{{ token }}"
    verify_ssl: no
    api_version: v1
    kind: PersistentVolumeClaim 
    namespace: "{{ namespace }}"
    name: "{{ item.metadata.name }}"
    state: absent
    wait: yes
    wait_timeout: 15 
  ignore_errors: true
  loop: "{{ app_pvc.resources }}"     
  loop_control:
    label: "To delete PVC {{ item.metadata.name }} in namespace {{ item.metadata.namespace }}"


